# Laravelのディレクトリ構造設計

TODOアプリのディレクトリ構造設計について検討しました。

## 1. 設計原則（結論）

TODOアプリのディレクトリ構造は以下の原則と具体的実装方針に基づいて設計します：

### 基本設計原則
- ドメイン中心の設計: 機能ではなく、ビジネスドメインに基づいた分割
- 責務の明確な分離: 各ディレクトリは明確な役割を持つ
- 階層的構造: 関連するコードを適切な階層で管理
- 命名規則の一貫性: ディレクトリ名とファイル名の規則統一
- 探しやすさの重視: 直感的に探せる構造

### ハイブリッドアプローチの採用

Laravelの標準ディレクトリ構造を基本としながら、ドメイン駆動設計の考え方を取り入れたハイブリッドアプローチを採用します。

#### 標準Laravel構造
- `app/Http/Controllers`: コントローラー
- `app/Models`: Eloquentモデル
- `resources/views`: ビューファイル

#### ドメイン指向構造
- `app/Domains/Todo`: TODO関連のコード
- `app/Domains/User`: ユーザー関連のコード
- `app/Domains/Category`: カテゴリー関連のコード

### 具体的な設計方針

#### ディレクトリ構造
```
app/
├── Console/                    # コマンド
├── Domains/                    # ドメイン別のコード
│   ├── Todo/                   # TODOドメイン
│   │   ├── Controllers/        # コントローラー
│   │   ├── Events/             # イベント
│   │   ├── Exceptions/         # 例外
│   │   ├── Models/             # Eloquentモデル
│   │   ├── Notifications/      # 通知
│   │   ├── Repositories/       # リポジトリ
│   │   ├── Requests/           # フォームリクエスト
│   │   ├── Resources/          # APIリソース
│   │   └── Services/           # サービス
│   └── User/                   # ユーザードメイン
│       └── ...                 # 同様の構造
├── Http/                       # HTTPリクエスト関連
│   ├── Controllers/            # 汎用コントローラー
│   └── Middleware/             # ミドルウェア
├── Providers/                  # サービスプロバイダ
└── Support/                    # ヘルパーと汎用クラス
```

#### 命名規則
- ディレクトリ名: 単数形、パスカルケース `Todo`
- ファイル名: 単数形、パスカルケース `TodoController.php`
- 名前空間: PSR-4に準拠 `App\Domains\Todo\Controllers`

#### ドメイン分離の基準
- 独立したビジネス概念: Todo、User、Categoryなど
- 十分な複雑さと規模: 少なくとも複数のクラスが必要なもの
- 明確な境界: 他のドメインとの依存関係が少ないもの

## 2. 検討ポイント

### ディレクトリ構造の基本設計パターン

#### 標準Laravel構造
- パターン: MVC分類に基づくディレクトリ分け
- 特徴: シンプルで学習コストが低い
- 課題: 大規模アプリでは肥大化しやすい

#### ドメイン中心構造 (DDD風)
- パターン: ビジネスドメインに基づくディレクトリ分け
- 特徴: ビジネスの文脈を反映した構造
- 課題: Laravelの標準から外れる部分の整理が必要

#### 機能単位構造
- パターン: 機能ごとのグループ化
- 特徴: 特定機能の開発がしやすい
- 課題: 機能間の重複コードが発生しやすい

### ディレクトリ階層の検討

#### 浅い階層 vs 深い階層
- 浅い階層: ファイル数は多いが、ナビゲーションが簡単
- 深い階層: 整理されているが、パスが長くなる

#### Laravelの標準に合わせる度合い
- 完全に標準: 学習コストが低いが、大規模開発では課題
- 拡張する: 標準を基本に必要な拡張のみ行う
- 完全カスタム: プロジェクト最適だが学習コスト高

### 命名規則の検討

#### 単数形 vs 複数形
- ディレクトリ名: 一般的には単数形（Domain, Service）
- コレクション的なもの: 複数形も検討（Controllers, Models）

#### ケーシング
- パスカルケース: クラス名と一致（Controller, Service）
- スネークケース: 設定ファイルなど（config_cache.php）
- ケバブケース: フロントエンド関連ファイル（todo-list.vue）

### 依存関係の管理

#### 境界の明確化
- 依存方向の制御: 内側のレイヤーは外側に依存しない
- コンポーネント間の依存: 明示的なインターフェースを通じて依存

#### 共通コードの配置
- 共通ユーティリティ: `app/Support`
- ドメイン間共有: `app/Shared`

## 3. 選択理由

### ハイブリッドアプローチを採用する理由
- Laravelの学習曲線維持: フレームワークの基本構造を尊重
- スケーラビリティ: 大規模化しても管理しやすい構造
- チーム開発の効率: ドメイン単位での並行開発がしやすい
- メンテナンス性: 関連するコードが近くにあり変更が容易

### ドメイン中心の設計を基本とする理由
- ビジネス要件との対応: コードがビジネスドメインを反映
- 凝集度の向上: 関連する機能が集約される
- 変更の影響範囲の限定: ドメイン内の変更は他に影響しにくい
- チーム編成との整合: ドメイン単位でのチーム分割がしやすい

### 責務の分離を重視する理由
- 単一責任の原則: 各クラスが明確な責任を持つ
- テスト容易性: 依存関係が明確で単体テストがしやすい
- コードの再利用: 適切に分離されたコードは再利用しやすい
- 保守性: 変更理由が限定され、影響範囲が予測しやすい

このような設計原則に基づき、プロジェクトの成長に合わせて柔軟にディレクトリ構造を発展させていくことが重要です。 